<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results - Consumerism Final Boss</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .page-layout {
            display: flex;
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            align-items: flex-start;
        }

        .camera-section {
            flex: 0 0 350px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .camera-container {
            background: rgba(0, 0, 0, 0.3);
            border: 3px solid #ff00ff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.5);
            position: relative;
            aspect-ratio: 3/4;
        }

        #cameraFeed {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        #photoCanvas {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .camera-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .camera-btn {
            padding: 12px 20px;
            font-size: 16px;
            font-weight: bold;
            border: 2px solid #ff00ff;
            background: linear-gradient(135deg, #ff00ff, #cc00ff);
            color: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-shadow: 0 0 10px rgba(255, 0, 255, 0.8);
            box-shadow: 0 0 15px rgba(255, 0, 255, 0.4);
        }

        .camera-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px rgba(255, 0, 255, 0.8);
        }

        .camera-btn:active {
            transform: scale(0.98);
        }

        .results-container {
            flex: 1;
            min-width: 0;
        }

        @media (max-width: 768px) {
            .page-layout {
                flex-direction: column;
                align-items: center;
            }

            .camera-section {
                flex: none;
                width: 100%;
                max-width: 350px;
            }

            .results-container {
                width: 100%;
            }
        }
    </style>
</head>
<body class="results-page">
    <div class="results-container">
        <h1 id="userName" class="user-name"></h1>
        <div class="result-box">
            <h2 id="tierTitle" class="tier-title"></h2>
            <p id="tierDescription" class="tier-description"></p>
            <div id="itemCount" class="item-count"></div>
        </div>
        
        <div class="button-group">
            <button id="screenshotBtn" class="screenshot-btn">ðŸ“¸ Save Result</button>
            <button id="restartBtn" class="restart-btn">Restart</button>
        </div>
    </div>
    
    <!-- Single volume toggle button -->
    <button id="volumeToggle" class="volume-toggle">
        <img id="volumeIcon" src="volumeon.png" alt="Volume" class="volume-icon">
    </button>
    
    <!-- html2canvas library for screenshots -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Retro game pink/purple sparkle cursor -->
    <script src="https://unpkg.com/cursor-effects@latest/dist/browser.js"></script>
    <script>
        new cursoreffects.fairyDustCursor({
            colors: ["#ff00ff", "#ff66ff", "#cc00ff", "#ff99ff", "#9900ff"]
        });
    </script>
    
    <script src="results-script.js"></script>
    <script>
        // Camera functionality
        let stream = null;
        const video = document.getElementById('cameraFeed');
        const canvas = document.getElementById('photoCanvas');
        const startCameraBtn = document.getElementById('startCameraBtn');
        const capturePhotoBtn = document.getElementById('capturePhotoBtn');
        const downloadPhotoBtn = document.getElementById('downloadPhotoBtn');
        const retakeBtn = document.getElementById('retakeBtn');

        // Start camera
        startCameraBtn.addEventListener('click', async () => {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'user',
                        width: { ideal: 1080 },
                        height: { ideal: 1920 }
                    } 
                });
                video.srcObject = stream;
                video.style.display = 'block';
                canvas.style.display = 'none';
                
                startCameraBtn.style.display = 'none';
                capturePhotoBtn.style.display = 'block';
                downloadPhotoBtn.style.display = 'none';
                retakeBtn.style.display = 'none';
            } catch (err) {
                alert('Error accessing camera: ' + err.message);
            }
        });

        // Capture photo
        capturePhotoBtn.addEventListener('click', () => {
            const context = canvas.getContext('2d');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            // Stop video stream
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            
            video.style.display = 'none';
            canvas.style.display = 'block';
            
            capturePhotoBtn.style.display = 'none';
            downloadPhotoBtn.style.display = 'block';
            retakeBtn.style.display = 'block';
        });

        // Download photo
        downloadPhotoBtn.addEventListener('click', () => {
            canvas.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'consumerism-pose.png';
                a.click();
                URL.revokeObjectURL(url);
            });
        });

        // Retake photo
        retakeBtn.addEventListener('click', async () => {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'user',
                        width: { ideal: 1080 },
                        height: { ideal: 1920 }
                    } 
                });
                video.srcObject = stream;
                video.style.display = 'block';
                canvas.style.display = 'none';
                
                capturePhotoBtn.style.display = 'block';
                downloadPhotoBtn.style.display = 'none';
                retakeBtn.style.display = 'none';
            } catch (err) {
                alert('Error accessing camera: ' + err.message);
            }
        });
    </script>
</body>
</html>